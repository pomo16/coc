<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>查询部落</title>
    <link rel="stylesheet" href="/common/css/common.css">
    <link rel="stylesheet" href="/common/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" href="/common/fullpage/fullpage.css">
    <link rel="stylesheet" href="/common/fontawesome/css/all.min.css">
    <script src="/common/js/jquery-3.3.1.min.js"></script>
    <script src="/common/bootstrap/bootstrap.min.js"></script>
    <script type="text/javascript" src="/common/fullpage/fullpage.js"></script>

    <style>
        .hh {display: inline;}
        .section{
            background-size: cover;
        }
        #section0{
            background-image: url(/common/img/background3.png);
        }
        #section0 h1{
            text-align:center;
            color: #353A3F;
            top: 50%;
            transform: translateY(-100%);
            position: relative;
        }
        #section1{
            background-image: url(/common/img/background2.png);
            padding: 6% 0 0 0;
            color: white;
        }
        .feature{
            display: table;
            width: 40%;
            height: 30%;
            vertical-align: middle;
            color: #fff;
            position: absolute;
            top: 40%;
            left: 30%;
        }
        .feature-inner {
            display: table-cell;
            vertical-align: middle;
            text-align: center;
        }
        .arrow {
            color:white;
            width: 20%;
            text-align:center;
            opacity:0.4;
        }
        .arrowDown {
            position: absolute;
            top: 75%;
            left: 40%;
        }
    </style>

    <script type="text/javascript">
        $(function(){
            $("#searchBt").click(function(){
                var id = $("#searchInput").val();
                var ajax = $.ajax({
                    url : "/test/json?name=test",
                    type : "GET",
                    //data : {id: id},
                    timeout:5000, //超时时间
                    beforeSend:function(){
                        $("#searchBt").removeClass("btn-primary").addClass("btn-secondary").html("<i class='fa fa-spinner fa-pulse' style='cursor:no-drop'></i>"); //在后台返回success之前显示loading图标
                    },
                    success : function(result) {
                        if (result == "false") {
                            alert("request failed");
                        } else {
                            reset();
                            var res = JSON.parse(result);
                            $("#name").text(res.name);
                            $("#clanLevel").text(" LV." + res.clanLevel);
                            $("#tag").text(res.tag.replace('%','#'));
                            $("#clanImg").html("<img style='height:70px;width:70px;' src='" + res.badgeUrls.small + "'/>");
                            $("#members").text(res.members + "/50");

                            $("#clanPoints").text("🏆" + res.clanPoints);
                            $("#clanVersusPoints").text("🏆" + res.clanVersusPoints);
                            $("#type").text(res.type);
                            $("#requiredTrophies").text("🏆" + res.requiredTrophies);
                            $("#description").text(res.description);

                            $("#warFrequency").text(res.warFrequency);
                            $("#warWinStreak").text(res.warWinStreak);
                            $("#isWarLogPublic").text(res.isWarLogPublic);
                            $("#warWins").text(res.warWins);
                            $("#warTies").text(res.warTies);
                            $("#warLosses").text(res.warLosses);
                            fullpage_api.moveSectionDown();
                        }
                        $("#searchBt").removeClass("btn-secondary").addClass("btn-primary").text("搜索");
                    },
                    fail : function() {
                        alert("请求失败");
                        $("#searchBt").removeClass("btn-secondary").addClass("btn-primary").text("搜索");
                    },
                    complete : function(XMLHttpRequest, status) { //请求完成后最终执行参数
                        if (status == 'timeout') {//超时,status还有success,error等值的情况
                            ajax.abort();
                            $("#searchBt").removeClass("btn-secondary").addClass("btn-primary").text("搜索");
                        }
                    }
                });
            });

            $("#arrowDownBt").click(function () {
                fullpage_api.moveSectionDown();
            });
        });

        function reset() {
            $("#name").text("");
            $("#clanLevel").text("");
            $("#tag").text("");
            $("#clanImg").html("");
            $("#members").text("");
            $("#clanPoints").text("");
            $("#clanVersusPoints").text("");
            $("#type").text("");
            $("#requiredTrophies").text("");
            $("#description").text("");
            $("#warFrequency").text("");
            $("#warWinStreak").text("");
            $("#warWins").text("");
            $("#isWarLogPublic").text("");
            $("#warTies").text("");
            $("#warLosses").text("");
        }

    </script>


</head>

<body>
    <div class="w-100">
        <!-- 导航栏 -->
        <div class="w-100">
            <div class="row">
                <div class="col-md-12">
                    <nav class=" navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
                        <a class="navbar-brand ml-3" href="/index"><img style="width: 80px;height: 40px;" src="/common/img/logo.png" /></a>
                        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText"
                                aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse" id="navbarText">
                            <ul class="navbar-nav mr-auto">
                                <li class="nav-item">
                                    <a class="nav-link" href="/index.html">主页</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="/players.html">查询玩家</a>
                                </li>
                                <li class="nav-item active">
                                    <a class="nav-link" href="#">查询部落</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="/making.html">广场</a>
                                </li>
                            </ul>
                            <span class="navbar-text">
                        <ul class="navbar-nav mr-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="/making.html">登录</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/making.html">注册</a>
                            </li>

                        </ul>
                    </span>
                        </div>
                    </nav>
                </div>
            </div>
        </div>

        <div id="fullpage">
            <!-- 第一页 -->
            <div class="section " id="section0">
                <h1>查询部落</h1>
                <div class="feature">
                    <div class="feature-inner">
                        <div class="input-group input-group-lg">
                            <input type="text" placeholder="Clans ID e.g.2LOU82P2" class="form-control input-lg">
                            <span class="btn-lg btn-primary input-group-addon input-group-btn" id="searchBt" style="cursor: pointer">搜索</span>
                        </div>
                    </div>
                </div>
                <div class="arrow arrowDown" id="arrowDownBt">
                    <i class="fas fa-chevron-down fa-7x" style="cursor:pointer"></i>
                </div>
            </div>

            <!-- 第二页 -->
            <div class="section" id="section1">
                <div class="row">
                    <h1 class="col-12">&nbsp;</h1>
                </div>
                <div class="container">
                    <div class="row">
                        <h1 class="col-1" id="clanImg"></h1>
                        <h1 class="col-9" id="name">暂无部落信息，请返回上一页搜索</h1>
                        <h5 class="col-2 m-auto" id="tag"></h5>
                    </div>
                    <div class="row">
                        <h1 class="col-12">&nbsp;</h1>
                    </div>
                    <div class="row text-left">
                        <h4 class="col-2">等级</h4>
                        <h4 class="col-4" id="clanLevel"></h4>
                        <h4 class="col-2">部落成员</h4>
                        <h4 class="col-4" id="members"></h4>
                    </div>
                    <div class="row">
                        <h4 class="col-12"></h4>
                    </div>
                    <div class="row text-left">
                        <h4 class="col-2">主世界杯数</h4>
                        <h4 class="col-4" id="clanPoints"></h4>
                        <h4 class="col-2">夜世界杯数</h4>
                        <h4 class="col-4" id="clanVersusPoints"></h4>
                    </div>
                    <div class="row">
                        <h4 class="col-12"></h4>
                    </div>
                    <div class="row text-left">
                        <h4 class="col-2">类型</h4>
                        <h4 class="col-4" id="type"></h4>
                        <h4 class="col-2">所需杯数</h4>
                        <h4 class="col-4" id="requiredTrophies"></h4>
                    </div>
                    <div class="row">
                        <h4 class="col-12"></h4>
                    </div>
                    <div class="row text-left">
                        <h4 class="col-2">部落简介</h4>
                        <h5 class="col-9" id="description"></h5>
                        <h4 class="col-1"></h4>
                    </div>

                    <div class="row">
                        <h1 class="col-12">&nbsp;</h1>
                    </div>
                    <div class="row text-left">
                        <h2 class="col-12">部落战</h2>
                    </div>
                    <div class="row text-left">
                        <h4 class="col-2">频率</h4>
                        <h4 class="col-2" id="warFrequency"></h4>
                        <h4 class="col-2">部落战连胜</h4>
                        <h4 class="col-2" id="warWinStreak"></h4>
                        <h4 class="col-2">对战记录公开</h4>
                        <h4 class="col-2" id="isWarLogPublic"></h4>
                    </div>
                    <div class="row text-left">
                        <h4 class="col-2">部落战胜局</h4>
                        <h4 class="col-2" id="warWins"></h4>
                        <h4 class="col-2">部落战平局</h4>
                        <h4 class="col-2" id="warTies"></h4>
                        <h4 class="col-2">部落战败局</h4>
                        <h4 class="col-2" id="warLosses"></h4>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        new fullpage('#fullpage', {
            verticalCentered: false
        });
    </script>
</body>

</html>

